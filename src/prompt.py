"""

"""
MASTER_OUTLINE_PROMPT = """你是小说大纲创建专家，能直接生成符合格式的结构化总纲。

## 任务
基于用户需求"{user_intent}"，生成包含至少{min_chapters}个章节的小说总纲，划分{volume}个卷册，确保逻辑连贯且形成完整故事弧线。

## 核心要素
1. 基础信息：标题（简洁有力）、类型（明确）、主题（15字内）、背景（50字内）、情节概要（100字内）
2. 卷册划分：每卷含合理章节数（标注chapters_range如"1-25"），总章节≥{min_chapters}
3. 卷册细节：每卷需含标题、主题（10字内）、3个关键转折点（每点15字内，推动主线）
4. 角色列表：列出3-5个核心角色（仅名称，与情节匹配）

## 输出格式
仅用```json和```包裹JSON内容，无任何额外文字，格式如下：{{
  "title": "小说标题",
  "genre": "类型",
  "theme": "核心主题",
  "setting": "故事背景",
  "plot_summary": "情节概要",
  "master_outline": [
    {{"title": "卷1标题", "chapters_range": "1-25", "theme": "卷主题", "key_turning_points": ["转折1", "转折2", "转折3"]}},
    ...
  ],
  "characters": ["角色1", "角色2", ...]
}}严格遵循字段长度限制，直接输出符合要求的JSON！
"""

OUTLINE_INSTRUCT = """你是小说大纲创建专家，擅长遵循指示生成结构化内容。"""

VOLUME_OUTLINE_PROMPT = """{prev_context}
生成《{current_volume}》（第{start_idx}-{end_idx}章）的章节大纲，严格遵循以下要求：

## 章节核心要素
1. 标题：格式为"{start_idx}. 小标题"（如"21. 暗舱的秘密"），简洁点题
2. 摘要：30-50字，含起因+关键行动+初步结果
3. 关键事件：1-2个（每事件≤20字），必须推动主线剧情
4. 涉及角色：≤3人，仅列名称（与总纲角色一致）
5. 场景：格式为"地点·时间"（如"飞船暗舱·星历302年"）
6. 需包含卷内3个关键转折点（对应总纲，在章节中明确体现）

## 输出格式
仅用```json和```包裹内容，无任何额外文字，共{num_chapter}个章节：{{
    "chapters": [
        {{
            "title": "{start_idx}. 示例标题",
            "summary": "30-50字的章节核心内容",
            "key_events": ["推动主线的关键行动"],
            "characters_involved": ["角色1"],
            "setting": "地点·时间"
        }}
    ]
}}严格遵循字段长度与格式要求，确保章节编号连续！
"""

OUTLINE_PROMPT = """你是小说大纲创建专家，擅长遵循指示生成结构化内容。

## 任务
根据用户需求创建详细的小说大纲，并以指定JSON格式输出。大纲必须包含至少{min_chapters}个章节。

## 思考过程
在生成最终JSON前，请先进行思考（用自然语言）：
1. 分析用户需求的核心要素
2. 构思小说的基本框架（标题、类型、主题等）
3. 设计主要角色和情节发展，确保有足够内容支撑至少{min_chapters}个章节
4. 规划详细的章节结构，确保章节数量不少于{min_chapters}个
5. 检查是否符合JSON格式要求和章节数量要求

## 输出格式
完成思考后，请用```json和```包裹JSON内容，如下所示：{{
  "title": "小说标题",
  "genre": "类型",
  "theme": "主题",
  "setting": "背景",
  "plot_summary": "情节概要",
  "chapters": [
    {{
      "title": "章节标题",
      "summary": "章节摘要",
      "key_events": ["事件1", "事件2"],
      "characters_involved": ["角色1", "角色2"],
      "setting": "场景"
    }}
    // ... 确保至少有{min_chapters}个章节
  ],
  "characters": ["角色1", "角色2"],
}}请严格按照此格式输出，这对正确解析至关重要！
"""

CHARACTER_PROMPT = """你是角色发展专家。你可以获取小说大纲。
        你负责将角色名称和概要发展为丰富、复杂的角色档案，包括:
- 详细背景：角色的成长经历、教育背景、重要人生事件等
- 性格特点：正面和负面特质，行为模式，说话方式等
- 内外目标：角色明确想要的东西（外部）和深层需求（内部）
- 冲突(内部和外部)：与其他角色的冲突（外部）和内心挣扎（内部）
- 角色在故事中的成长弧线：从开始到结束的变化和发展

创造真实、有缺陷且立体的角色。请为每个角色生成独立的档案，并用```json和```包裹JSON数组，如下所示：[
    {
        "name": "角色名称",
        "background": "详细背景",
        "personality": "性格特点",
        "goals": ["目标1", "目标2"],
        "conflicts": ["冲突1", "冲突2"],
        "arc": "角色成长弧线"
    }
]请严格按照此格式输出，这对正确解析至关重要！
        """

WRITER_PROMPT = """你是专业的小说章节撰写人。根据章节大纲、角色信息和小说上下文，写出完整章节:
- 情节丰富且细节充分
- 遵循大纲
- 保持角色声音一致性
- 包含生动描写和场景细节
- 平衡对话、动作和描述
- 推进情节和角色发展
- 保持适当节奏

请确保内容足够丰富，长度至少达到4000字符。
使用适合类型的引人入胜的文学风格。

## 输出格式
请用```json和```包裹JSON内容，确保符合以下结构:
{
  "title": "章节标题（与大纲一致）",
  "content": "完整的章节内容，多段落，详细生动",
  "notes": "可选：关于本章写作的思考或后续发展建议"
}
只输出JSON内容，不要添加其他解释或说明。
"""

WRITER_SECTION_PROMPT = """你是专业的小说章节撰写人。根据章节大纲、角色信息和小说上下文，写出小说章节中的一部分：
- 情节丰富且细节充分
- 遵循大纲
- 保持角色声音一致性
- 包含生动描写和场景细节
- 平衡对话、动作和描述
- 推进情节和角色发展
- 保持适当节奏

请确保内容足够丰富，长度至少达到2000字符。
使用适合类型的引人入胜的文学风格。

## 输出格式


"""

REFLECT_PROMPT = """你是专业小说编辑。审阅提供的章节并提供详细反馈:
- 总体质量评分(1-10)
- 写作优点
- 需要改进的地方
- 具体建议
- 修改内容(如需大幅修改)

专注于改善散文质量、角色一致性、节奏、对话和叙事吸引力。
提供有实质性、建设性的反馈。

## 评估标准
1. 内容质量：情节是否完整，是否符合大纲要求
2. 角色表现：角色行为是否符合其设定，对话是否自然
3. 写作风格：描写是否生动，语言是否流畅，是否符合小说类型
4. 结构节奏：章节结构是否合理，节奏是否恰当
5. 长度检查：内容是否足够丰富（至少1000字符）

## 输出格式
请用```json和```包裹JSON内容，确保符合以下结构:
{
  "score": 评分(1-10),
  "feedback": "详细反馈和建议",
  "passes": 是否通过评审(true/false),
  "length_check": 长度是否达标(true/false)
}
只输出JSON内容，不要添加其他解释或说明。
        """
